<!DOCTYPE html>
<html lang="ko-KR">
<head>
<meta charset="UTF-8">
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta http-equiv="Content-Script-Type" content="text/javascript" />
<meta http-equiv="Content-Style-Type" content="text/css" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0, viewport-fit=cover" />
<meta http-equiv="X-UA-compatible" content="IE=edge">

<meta http-equiv="subject" content="" />
<meta http-equiv="title" content="" />
<meta http-equiv="author" content="" />
<meta name="keywords" content="" />
<meta name="description" content="" />
<meta property="og:type" content="website">
<meta property="og:title" content="">
<meta property="og:description" content="">
<meta property="og:image" content="">
<meta property="og:url" content="">

<link rel="stylesheet" type="text/css" href="./assets/css/common.css">
<link rel="stylesheet" type="text/css" href="./assets/css/style.css">
<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/gsap.min.js"></script>
<script type="text/javascript" src="./assets/js/plugin/jquery-3.4.1.min.js"></script>
<title>animation</title>

</head>
<body>
    <div class="wrap">
        <!-- contents -->
        <div class="contents test">
            <div class="box1">
                <div class="counter"></div>
            </div>
            <div class="box2">
                box2
            </div>
            <ul class="box-list">
               <li>box-item1</li> 
               <li>box-item2</li> 
               <li>box-item3</li> 
               <li>box-item4</li> 
            </ul>
        </div>
        <!-- // contents -->

        <!-- loading-bar -->
        <div class="loading-wrap">
            <div class="loading-bar">
                <ul class="img-list">
                    <li><img src="./assets/img/loading_01.png" alt=""></li>
                    <li><img src="./assets/img/loading_02.png" alt=""></li>
                    <li><img src="./assets/img/loading_03.png" alt=""></li>
                </ul>
                <ul class="txt-list">
                    <li><em>김디비</em>님!</li>
                    <li>맞춤 보험료를</li>
                    <li>계산중 입니다</li>
                </ul>
            </div>
        </div>
        <!-- //loading-bar -->
    </div>
    <script>
        const loadingWrap = $('.loading-wrap');
        const mainCon = $('.contents');
        const loadingImgList = $('.loading-wrap .loading-bar .img-list');
        const loadingImg = $('.loading-wrap .loading-bar .img-list li');
        const loadingTxt = $('.loading-wrap .loading-bar .txt-list li');
        let cnt = 0;

        $(function(){
            loadingBarFn();

            //임시 : 데이터 로드 후 삭제
            setTimeout(function(){
                loadingBarHide();
            }, 3000);
        });

        function loadingBarFn(){
            loadingImgList.css({'transform':'translate(0,' + -100*cnt + '%)', 'transition': '0.5s'});
            loadingTxt.eq(cnt).addClass('on').siblings().removeClass('on');
            cnt++;

            if(cnt == loadingImg.length) return;
            setTimeout(function(){
                loadingBarFn();
            }, 1000);
        }

        //로딩바 삭제
        function loadingBarHide(){
            loadingWrap.fadeOut('1000');
            mainCon.animate({
                left: 0
            }, 500, function(){
                new Promise(function(reslove){
                    reslove();
                })
                .then(countRolling)
                .then(ani2)
            });
        }

        //gsap
        gsap.fromTo(".box2", {
            opacity: 0,
            top: -20
        }, {
            opacity: 1,
            top: 0,
            duration: 0.5,
            onComplete: () => {
                
            }
        });

        function countRolling(){
            $('.test .box1').addClass('on');
        }

        // function test(){
        //     return new Promise(function(reslove){
        //         reslove();
        //     });
        // }

        function ani1(){
            setTimeout(function(){
                $('.test .box1').addClass('on');
                console.log(2);
            }, 500);
        }

        function ani2(){
            setTimeout(function(){
                $('.test .box2').addClass('on');
                console.log(345);
            }, 1000);
        }

        // function ani1(){
        //     return new Promise(function(reslove){
        //         setTimeout(function(){
        //             $('.test .box1').addClass('on');
        //             console.log(2);
        //         }, 500);
        //     });
        // }

        // function ani2(){
        //     return new Promise(function(resolve){
        //         setTimeout(function(){
        //             $('.test .box2').addClass('on');
        //             console.log(345);
        //         }, 1000);
        //     });
        // }

        // let test = async function(){
        //     await ani1();
        //     await ani2();
        // }
    </script>
</body>
</html>
